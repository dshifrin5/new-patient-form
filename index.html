<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>New Patient Packet</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      background-image: url('https://raw.github.com/dshifrin5/new-patient-form/main/66D89306-626F-4A08-82D4-0AF26460A22D.png');
      background-size: cover;
      background-repeat: repeat-y;
      background-attachment: fixed;
      background-position: center top;
      background-color: #d6f4ff;
    }

    .container {
      background-color: rgba(234, 248, 255, 0.95);
      border-radius: 10px;
      padding: 2rem;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
    }

    canvas {
      border: 1px solid #ccc;
      width: 100%;
      height: 200px;
    }

    .step {
      display: none;
    }

    .step.active {
      display: block;
    }

    .invalid {
      border: 2px solid red !important;
    }

    .required-star {
      color: red;
      margin-left: 4px;
    }

    label span.optional {
      font-weight: normal;
      font-style: italic;
      font-size: 0.9em;
      color: gray;
      margin-left: 5px;
    }
  </style>

</head>
<body class="bg-light">
<div class="container py-4">
  <div class="text-center mb-3">
    <img src="https://raw.githubusercontent.com/dshifrin5/new-patient-form/main/Bite-Squad-Small-ezgif.com-webp-to-png-converter.png" alt="Pediatric Dentistry NYC Logo" style="max-width: 250px; height: auto;" />
  </div>
  <h2 class="text-center mb-4">New Patient Packet</h2>
  <form id="multiStepForm">
    <!-- Step 1 -->
    <div class="step active" id="step1">
      <h4>Patient Information</h4>
      <div class="row">
        <div class="col-md-4 mb-3">
          <label class="form-label">First Name <span class="required-star">*</span></label>
          <input type="text" class="form-control required" name="first_name" />
        </div>
        <div class="col-md-4 mb-3">
          <label class="form-label">Last Name <span class="required-star">*</span></label>
          <input type="text" class="form-control required" name="last_name" />
        </div>
        <div class="col-md-4 mb-3">
          <label class="form-label">Middle Initial</label>
          <input type="text" class="form-control" name="middle_initial" maxlength="1" />
        </div>
      </div>
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Gender <span class="required-star">*</span></label>
          <select class="form-select required" name="gender">
            <option value="">Select...</option>
            <option>Male</option>
            <option>Female</option>
            <option>Other</option>
          </select>
        </div>
        <div class="col-md-6 mb-3">
          <label class="form-label">Family Status <span class="required-star">*</span></label>
          <select class="form-select required" name="family_status">
            <option value="">Select...</option>
            <option>Married</option>
            <option>Single</option>
            <option>Child</option>
            <option>Other</option>
          </select>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Birth Date <span class="required-star">*</span></label>
          <input type="date" class="form-control required" name="birth_date" />
        </div>
        <div class="col-md-6 mb-3">
          <label class="form-label">Email Address <span class="required-star">*</span></label>
          <input type="email" class="form-control required" name="email" />
        </div>
      </div>
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Mobile Phone <span class="required-star">*</span></label>
          <input type="tel" class="form-control required" name="mobile" />
        </div>
        <div class="col-md-6 mb-3">
          <label class="form-label">Home Phone <span class="optional">(optional)</span></label>
          <input type="tel" class="form-control" name="home_phone" />
        </div>
      </div>
      <div class="mb-3">
        <label class="form-label">Best Time to Call <span class="required-star">*</span></label>
        <select class="form-select required" name="call_time">
          <option value="">Select...</option>
          <option>Morning</option>
          <option>Afternoon</option>
          <option>Evening</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Address 1 (Street Address) <span class="required-star">*</span></label>
        <input type="text" class="form-control required" name="address1" />
      </div>
      <div class="mb-3">
        <label class="form-label">Address 2 <span class="optional">(optional)</span></label>
        <input type="text" class="form-control" name="address2" />
      </div>
      <div class="row">
        <div class="col-md-4 mb-3">
          <label class="form-label">City <span class="required-star">*</span></label>
          <input type="text" class="form-control required" name="city" />
        </div>
        <div class="col-md-4 mb-3">
          <label class="form-label">State <span class="required-star">*</span></label>
          <select class="form-select required" name="state">
            <option value="">Select a state...</option>
            <option value="NY">New York</option>
            <option value="AL">Alabama</option>
            <option value="AK">Alaska</option>
            <option value="AZ">Arizona</option>
            <option value="AR">Arkansas</option>
            <option value="CA">California</option>
            <option value="CO">Colorado</option>
            <option value="CT">Connecticut</option>
            <option value="DE">Delaware</option>
            <option value="DC">District of Columbia</option>
            <option value="FL">Florida</option>
            <option value="GA">Georgia</option>
            <option value="HI">Hawaii</option>
            <option value="ID">Idaho</option>
            <option value="IL">Illinois</option>
            <option value="IN">Indiana</option>
            <option value="IA">Iowa</option>
            <option value="KS">Kansas</option>
            <option value="KY">Kentucky</option>
            <option value="LA">Louisiana</option>
            <option value="ME">Maine</option>
            <option value="MD">Maryland</option>
            <option value="MA">Massachusetts</option>
            <option value="MI">Michigan</option>
            <option value="MN">Minnesota</option>
            <option value="MS">Mississippi</option>
            <option value="MO">Missouri</option>
            <option value="MT">Montana</option>
            <option value="NE">Nebraska</option>
            <option value="NV">Nevada</option>
            <option value="NH">New Hampshire</option>
            <option value="NJ">New Jersey</option>
            <option value="NM">New Mexico</option>
            <option value="NY">New York</option>
            <option value="NC">North Carolina</option>
            <option value="ND">North Dakota</option>
            <option value="OH">Ohio</option>
            <option value="OK">Oklahoma</option>
            <option value="OR">Oregon</option>
            <option value="PA">Pennsylvania</option>
            <option value="RI">Rhode Island</option>
            <option value="SC">South Carolina</option>
            <option value="SD">South Dakota</option>
            <option value="TN">Tennessee</option>
            <option value="TX">Texas</option>
            <option value="UT">Utah</option>
            <option value="VT">Vermont</option>
            <option value="VA">Virginia</option>
            <option value="WA">Washington</option>
            <option value="WV">West Virginia</option>
            <option value="WI">Wisconsin</option>
            <option value="WY">Wyoming</option>
          </select>

        </div>
        <div class="col-md-4 mb-3">
          <label class="form-label">Zip Code <span class="required-star">*</span></label>
          <input type="text" class="form-control required" name="zip" />
        </div>
      </div>
      <button type="button" class="btn btn-primary" onclick="validateStepAndNext()">Next</button>
    </div>

    <!-- Step 2 (Rewritten as requested) -->
    <div class="step" id="step2">
      <h4>Primary Dental Insurance</h4>
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Insured First Name <span class="required-star">*</span></label>
          <input type="text" class="form-control required" name="insured_first" />
        </div>
        <div class="col-md-6 mb-3">
          <label class="form-label">Insured Last Name <span class="required-star">*</span></label>
          <input type="text" class="form-control required" name="insured_last" />
        </div>
      </div>
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Insured Birth Date <span class="required-star">*</span></label>
          <input type="date" class="form-control required" name="insured_birth" />
        </div>
        <div class="col-md-6 mb-3">
          <label class="form-label">Insured Employer's Name <span class="required-star">*</span></label>
          <input type="text" class="form-control required" name="insured_employer" />
        </div>
      </div>
      <div class="mb-3">
        <label class="form-label">Insurance Plan Name <span class="required-star">*</span></label>
        <input type="text" class="form-control required" name="plan_name" />
      </div>
      <div class="mb-3">
        <label class="form-label">Patient's Relationship to Insured <span class="required-star">*</span></label>
        <input type="text" class="form-control required" name="relationship" />
      </div>
      <div class="mb-3">
        <label class="form-label">Insurance ID Number <span class="required-star">*</span></label>
        <input type="text" class="form-control required" name="insurance_id" />
      </div>
      <div class="mb-3">
        <label class="form-label">Upload Insurance Card Picture <span class="optional">(optional)</span></label>
        <input type="file" class="form-control" name="insurance_card" accept="image/*" />
      </div>
      <div class="form-check mb-3">
        <input class="form-check-input required" type="checkbox" name="insurance_consent" id="insurance_consent" />
        <label class="form-check-label" for="insurance_consent">
          By checking this box, I authorize my insurance company to pay the dentist all insurance benefits rendered. I authorize the use of this electronic signature on all insurance submissions. I authorize the dentist to release all information necessary to secure the payment of benefits. I understand that I am financially responsible for all charges whether or not paid by insurance.
        </label>
      </div>
      <div class="mb-3">
        <label class="form-label">Do you have Secondary Dental Insurance? <span class="required-star">*</span></label>
        <select class="form-select required" name="has_secondary" onchange="document.getElementById('secondaryUpload').style.display = this.value === 'Yes' ? 'block' : 'none'">
          <option value="">Select...</option>
          <option>Yes</option>
          <option>No</option>
        </select>
      </div>
      <div class="mb-3" id="secondaryUpload" style="display:none">
        <label class="form-label">Upload Secondary Insurance Card <span class="optional">(optional)</span></label>
        <input type="file" class="form-control" name="secondary_card" accept="image/*" />
      </div>
      <div class="d-flex justify-content-between">
        <button type="button" class="btn btn-secondary" onclick="prevStep()">Back</button>
        <button type="button" class="btn btn-primary" onclick="validateStepAndNext()">Next</button>
      </div>
    </div>

    <div class="step" id="step3">
      <h4>Responsible Party Information</h4>
      <div class="mb-3">
        <label class="form-label">Who is the patient?</label>
        <select class="form-select required" name="responsible_choice" id="responsibleChoice" onchange="toggleParentFields()">
          <option value="">Select...</option>
          <option value="self">Myself</option>
          <option value="child">My Child</option>
        </select>
      </div>
      <div id="parentFields" style="display: none;">
        <div class="row">
          <div class="col-md-6 mb-3">
            <label class="form-label">Parent First Name <span class="required-star">*</span></label>
            <input type="text" class="form-control required-parent" name="parent_first_name">
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Parent Last Name <span class="required-star">*</span></label>
            <input type="text" class="form-control required-parent" name="parent_last_name">
          </div>
        </div>
        <div class="row">
          <div class="col-md-6 mb-3">
            <label class="form-label">Gender <span class="required-star">*</span></label>
            <select class="form-select required-parent" name="parent_gender">
              <option value="">Select...</option>
              <option>Male</option>
              <option>Female</option>
              <option>Other</option>
            </select>
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Family Status <span class="required-star">*</span></label>
            <select class="form-select required-parent" name="parent_family_status">
              <option value="">Select...</option>
              <option>Married</option>
              <option>Single</option>
              <option>Other</option>
            </select>
          </div>
        </div>
        <div class="row">
          <div class="col-md-6 mb-3">
            <label class="form-label">Birth Date <span class="required-star">*</span></label>
            <input type="date" class="form-control required-parent" name="parent_birth_date">
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Email Address <span class="required-star">*</span></label>
            <input type="email" class="form-control required-parent" name="parent_email">
          </div>
        </div>
      </div>
      <button type="button" class="btn btn-secondary" onclick="prevStep()">Back</button>
      <button type="button" class="btn btn-primary" onclick="validateStepAndNext()">Next</button>
    </div>

  <!-- Step 4 -->
  <div class="step" id="step4">
    <h4>Medical History</h4>

    <div class="mb-3">
      <label class="form-label">Physician's Name <span class="required-star">*</span></label>
      <input type="text" class="form-control required" name="physician_name">
    </div>

    <div class="mb-3">
      <label class="form-label">Preferred Pharmacy Name and Phone/Location <span class="required-star">*</span></label>
      <input type="text" class="form-control required" name="pharmacy_info">
    </div>

    <div class="mb-3">
      <label class="form-label">Have you had any serious illness or operations? <span class="required-star">*</span></label>
      <select class="form-select required" name="serious_illness" onchange="document.getElementById('illness_desc').style.display = this.value === 'Yes' ? 'block' : 'none'">
        <option value="">Select...</option>
        <option>Yes</option>
        <option>No</option>
      </select>
    </div>

    <div class="mb-3" id="illness_desc" style="display:none">
      <label class="form-label">If yes, describe:</label>
      <textarea class="form-control" name="illness_description"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Have you ever had a blood transfusion? <span class="required-star">*</span></label>
      <select class="form-select required" name="blood_transfusion" onchange="document.getElementById('transfusion_date').style.display = this.value === 'Yes' ? 'block' : 'none'">
        <option value="">Select...</option>
        <option>Yes</option>
        <option>No</option>
      </select>
    </div>

    <div class="mb-3" id="transfusion_date" style="display:none">
      <label class="form-label">If yes, approximate date:</label>
      <input type="text" class="form-control" name="transfusion_date">
    </div>

    <div class="mb-3">
      <label class="form-label">Females Only:</label>
      <div class="form-check"><input class="form-check-input" type="checkbox" name="pregnant" value="Yes"> <label class="form-check-label">Pregnant</label></div>
      <div class="form-check"><input class="form-check-input" type="checkbox" name="nursing" value="Yes"> <label class="form-check-label">Nursing</label></div>
      <div class="form-check"><input class="form-check-input" type="checkbox" name="birth_control" value="Yes"> <label class="form-check-label">Taking birth control pills</label></div>
    </div>

    <div class="mb-3">
      <label class="form-label">Check if you have or have had any of the following:</label>
      <div class="row">
        <div class="col-md-6">
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Anemia"> <label class="form-check-label">Anemia</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Arthritis"> <label class="form-check-label">Arthritis</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Artificial Joints"> <label class="form-check-label">Artificial Joints</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Asthma"> <label class="form-check-label">Asthma</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Blood Disease"> <label class="form-check-label">Blood Disease</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Cancer"> <label class="form-check-label">Cancer</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Cerebral Palsy"> <label class="form-check-label">Cerebral Palsy</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="DIFLUCAN"> <label class="form-check-label">DIFLUCAN</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Development delay"> <label class="form-check-label">Development delay</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Diabetes"> <label class="form-check-label">Diabetes</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Ehlers-Danlos Syndrome"> <label class="form-check-label">Ehlers-Danlos Syndrome</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Epilepsy"> <label class="form-check-label">Epilepsy</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Fainting"> <label class="form-check-label">Fainting</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Genetic Syndrome"> <label class="form-check-label">Genetic Syndrome</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Glaucoma"> <label class="form-check-label">Glaucoma</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="HIV/AIDS"> <label class="form-check-label">HIV/AIDS</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Hashimoto Disease"> <label class="form-check-label">Hashimoto Disease</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Head Injuries"> <label class="form-check-label">Head Injuries</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Heart Conditions"> <label class="form-check-label">Heart Conditions</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Heart Disease"> <label class="form-check-label">Heart Disease</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Heart Murmur"> <label class="form-check-label">Heart Murmur</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Hemophilia"> <label class="form-check-label">Hemophilia</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Hepatitis"> <label class="form-check-label">Hepatitis</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="High Blood Pressure"> <label class="form-check-label">High Blood Pressure</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Jaundice"> <label class="form-check-label">Jaundice</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Joint Conditions"> <label class="form-check-label">Joint Conditions</label></div>
        </div>
        <div class="col-md-6">
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Kidney Disease"> <label class="form-check-label">Kidney Disease</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Latent TB"> <label class="form-check-label">Latent TB</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Liver Disease"> <label class="form-check-label">Liver Disease</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Muscular Dystrophy"> <label class="form-check-label">Muscular Dystrophy</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Nervous Disorders"> <label class="form-check-label">Nervous Disorders</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Neutropenia"> <label class="form-check-label">Neutropenia</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Pacemaker"> <label class="form-check-label">Pacemaker</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Radiation Treatment"> <label class="form-check-label">Radiation Treatment</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Respiratory Problems"> <label class="form-check-label">Respiratory Problems</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Rheumatic Fever"> <label class="form-check-label">Rheumatic Fever</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Rheumatism"> <label class="form-check-label">Rheumatism</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Scarlet Fever"> <label class="form-check-label">Scarlet Fever</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Seizure"> <label class="form-check-label">Seizure</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Shortness of Breath"> <label class="form-check-label">Shortness of Breath</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Sinus Problems"> <label class="form-check-label">Sinus Problems</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Situs inversus"> <label class="form-check-label">Situs inversus</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Spina Bifida"> <label class="form-check-label">Spina Bifida</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Stomach Problems"> <label class="form-check-label">Stomach Problems</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Stroke"> <label class="form-check-label">Stroke</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Thyroid Problems"> <label class="form-check-label">Thyroid Problems</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Tuberculosis"> <label class="form-check-label">Tuberculosis</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Tumors"> <label class="form-check-label">Tumors</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Ulcers"> <label class="form-check-label">Ulcers</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Venereal Disease"> <label class="form-check-label">Venereal Disease</label></div>
          <div class="form-check"><input class="form-check-input" type="checkbox" name="conditions[]" value="Williams Syndrome"> <label class="form-check-label">Williams Syndrome</label></div>
        </div>
      </div>
    </div>


    <div class="mb-3">
      <label class="form-label">Are you taking any medication? <span class="required-star">*</span></label>
      <select class="form-select required" name="taking_medication" onchange="document.getElementById('med_list').style.display = this.value === 'Yes' ? 'block' : 'none'">
        <option value="">Select...</option>
        <option>Yes</option>
        <option>No</option>
      </select>
    </div>

    <div class="mb-3" id="med_list" style="display:none">
      <label class="form-label">If yes, please list:</label>
      <textarea class="form-control" name="medications"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Do you have allergies to any medication? <span class="required-star">*</span></label>
      <select class="form-select required" name="allergies" onchange="document.getElementById('allergy_list').style.display = this.value === 'Yes' ? 'block' : 'none'">
        <option value="">Select...</option>
        <option>Yes</option>
        <option>No</option>
      </select>
    </div>

    <div class="mb-3" id="allergy_list" style="display:none">
      <label class="form-label">If yes, please list:</label>
      <textarea class="form-control" name="allergy_details"></textarea>
    </div>

    <div class="form-check mb-3">
      <input class="form-check-input required" type="checkbox" name="final_acknowledgement" id="final_acknowledgement" />
      <label class="form-check-label" for="final_acknowledgement">
        By checking this box, I acknowledge that I have reviewed ALL questions/alerts on this questionnaire and responded accordingly. There are no other medical conditions or medications/allergies that have not been listed. I am aware that I must notify the practice of any future changes. This will serve as my electronic signature.
      </label>
    </div>

    <div class="d-flex justify-content-between">
      <button type="button" class="btn btn-secondary" onclick="prevStep()">Back</button>
      <button type="button" class="btn btn-primary" onclick="validateStepAndNext()">Next</button>
    </div>
  </div>

  <div class="step" id="step-5">
    <h2>Step 5: Consent for Services and Financial Policy</h2>

    <div class="accordion" id="accordionStep5">

      <!-- 1. Consent for Services -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingOne">
          <button class="accordion-button" type="button" data-bs-toggle="collapse"
                  data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
            Consent for Services
          </button>
        </h2>
        <div class="px-4 pt-2">
          <div class="form-check">
            <input class="form-check-input required" type="checkbox" id="consentService" name="consentService">
            <label class="form-check-label" for="consentService">
              <span class="required-star">*</span>By checking this box, I acknowledge that I have read this statement and agree to the consents.
            </label>
          </div>
        </div>
        <div id="collapseOne" class="accordion-collapse collapse"
             aria-labelledby="headingOne" data-bs-parent="#accordionStep5">
          <div class="accordion-body">
            <p>
              I consent to the use or disclosure of my "protected health information" as defined in
              the Health Insurance Portability and Accountability Act of 1996 (HIPAA)...
            </p>
          </div>
        </div>
      </div>

      <!-- 2. Cancellation and Broken Appointment Policy -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingTwo">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
            Cancellation and Broken Appointment Policy
          </button>
        </h2>
        <div class="px-4 pt-2">
          <div class="form-check">
            <input class="form-check-input required" type="checkbox" id="consentCancel" name="consentCancel">
            <label class="form-check-label" for="consentCancel">
              <span class="required-star">*</span>By checking this box, I acknowledge that I have read this statement and agree to the consents.

            </label>
          </div>
        </div>
        <div id="collapseTwo" class="accordion-collapse collapse"
             aria-labelledby="headingTwo" data-bs-parent="#accordionStep5">
          <div class="accordion-body">
            <p>
              Our number one concern is our patient’s dental health... Please understand that this
              is a courtesy call. DO NOT DEPEND ON THIS.
            </p>
          </div>
        </div>
      </div>

      <!-- 3. HIPAA Acknowledgement -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingThree">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
            HIPAA Acknowledgement
          </button>
        </h2>
        <div class="px-4 pt-2">
          <div class="form-check">
            <input class="form-check-input required" type="checkbox" id="consentHIPAA" name="consentHIPAA">
            <label class="form-check-label" for="consentHIPAA">
              <span class="required-star">*</span>By checking this box, I acknowledge that I have read this statement and agree to the consents.
            </label>
          </div>
        </div>
        <div id="collapseThree" class="accordion-collapse collapse"
             aria-labelledby="headingThree" data-bs-parent="#accordionStep5">
          <div class="accordion-body">
            <p>
              THIS NOTICE DESCRIBES HOW MEDICAL INFORMATION ABOUT YOU MAY BE USED AND
              DISCLOSED AND HOW YOU CAN GET ACCESS TO THIS INFORMATION...
            </p>
          </div>
        </div>
      </div>

      <!-- 4. Statement Of Patient Financial Responsibility -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingFour">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
            Statement Of Patient Financial Responsibility
          </button>
        </h2>
        <div class="px-4 pt-2">
          <div class="form-check">
            <input class="form-check-input required" type="checkbox" id="financialResponsibility" name="financialResponsibility">
            <label class="form-check-label" for="financialResponsibility">
              <span class="required-star">*</span>By checking this box, I acknowledge that I have read this statement and agree to the consents.
            </label>
          </div>
        </div>
        <div id="collapseFour" class="accordion-collapse collapse"
             aria-labelledby="headingFour" data-bs-parent="#accordionStep5">
          <div class="accordion-body">
            <p>
              YURY SLEPAK DDS P.C. D\B\A PEDIATRIC DENTISTRY NYC ("PEDIATRIC DENTISTRY NYC") appreciates the confidence you have shown in...
            </p>
          </div>
        </div>
      </div>

      <!-- 5. Consent for Treatment & Authorization to Release Information -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingFive">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
            Consent for Treatment & Authorization to Release Information
          </button>
        </h2>
        <div class="px-4 pt-2">
          <div class="form-check">
            <input class="form-check-input required" type="checkbox" id="consentTreatmentRelease" name="consentTreatmentRelease">
            <label class="form-check-label" for="consentTreatmentRelease">
              <span class="required-star">*</span>By checking this box, I acknowledge that I have read this statement and agree to the consents.
            </label>
          </div>
        </div>
        <div id="collapseFive" class="accordion-collapse collapse"
             aria-labelledby="headingFive" data-bs-parent="#accordionStep5">
          <div class="accordion-body">
            <p>
              I hereby authorize PEDIATRIC DENTISTRY NYC through its appropriate personnel to furnish medical care and treatment to me (or the above...
            </p>
          </div>
        </div>
      </div>

      <!-- 6. Informed Consent for Dental Services -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingSix">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
            Informed Consent for Dental Services
          </button>
        </h2>
        <div class="px-4 pt-2">
          <div class="form-check">
            <input class="form-check-input required" type="checkbox" id="consentDental" name="consentDental">
            <label class="form-check-label" for="consentDental">
              <span class="required-star">*</span>By checking this box, I acknowledge that I have read this statement and agree to the consents.
            </label>
          </div>
        </div>
        <div id="collapseSix" class="accordion-collapse collapse"
             aria-labelledby="headingSix" data-bs-parent="#accordionStep5">
          <div class="accordion-body">
            <p>
              I understand that I am having, and authorize the following work done [Indicate all services being provided]:...
            </p>
          </div>
        </div>
      </div>

      <!-- 7. Drugs and Medications -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingSeven">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#collapseSeven" aria-expanded="false" aria-controls="collapseSeven">
            Drugs and Medications
          </button>
        </h2>
        <div class="px-4 pt-2">
          <div class="form-check">
            <input class="form-check-input required" type="checkbox" id="consentMedications" name="consentMedications">
            <label class="form-check-label" for="consentMedications">
              <span class="required-star">*</span>By checking this box, I acknowledge that I have read this statement and agree to the consents.
            </label>
          </div>
        </div>
        <div id="collapseSeven" class="accordion-collapse collapse"
             aria-labelledby="headingSeven" data-bs-parent="#accordionStep5">
          <div class="accordion-body">
            <p>
              I understand that antibiotics, analgesics and other medications may cause reactions causing redness and swelling of tissue,...
            </p>
          </div>
        </div>
      </div>

      <!-- 8. Changes in Treatment Plan -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingEight">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#collapseEight" aria-expanded="false" aria-controls="collapseEight">
            Changes in Treatment Plan
          </button>
        </h2>
        <div class="px-4 pt-2">
          <div class="form-check">
            <input class="form-check-input required" type="checkbox" id="consentPlanChange" name="consentPlanChange">
            <label class="form-check-label" for="consentPlanChange">
              <span class="required-star">*</span>By checking this box, I acknowledge that I have read this statement and agree to the consents.
            </label>
          </div>
        </div>
        <div id="collapseEight" class="accordion-collapse collapse"
             aria-labelledby="headingEight" data-bs-parent="#accordionStep5">
          <div class="accordion-body">
            <p>
              I understand that during treatment, it may be necessary to change or add procedures because of conditions found while working...
            </p>
          </div>
        </div>
      </div>

      <!-- 9. Removal of Teeth -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingNine">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#collapseNine" aria-expanded="false" aria-controls="collapseNine">
            Removal of Teeth
          </button>
        </h2>
        <div class="px-4 pt-2">
          <div class="form-check">
            <input class="form-check-input required" type="checkbox" id="consentTeethRemoval" name="consentTeethRemoval">
            <label class="form-check-label" for="consentTeethRemoval">
              <span class="required-star">*</span>By checking this box, I acknowledge that I have read this statement and agree to the consents.
            </label>
          </div>
        </div>
        <div id="collapseNine" class="accordion-collapse collapse"
             aria-labelledby="headingNine" data-bs-parent="#accordionStep5">
          <div class="accordion-body">
            <p>
              Alternatives to removal have been explained to me (root canal therapy, crowns...
            </p>
          </div>
        </div>
      </div>

      <!-- 10. Oral Surgery and Dental Extractions -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingTen">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#collapseTen" aria-expanded="false" aria-controls="collapseTen">
            Oral Surgery and Dental Extractions
          </button>
        </h2>
        <div class="px-4 pt-2">
          <div class="form-check">
            <input class="form-check-input required" type="checkbox" id="consentSurgery" name="consentSurgery">
            <label class="form-check-label" for="consentSurgery">
              <span class="required-star">*</span>By checking this box, I acknowledge that I have read this statement and agree to the consents.
            </label>
          </div>
        </div>
        <div id="collapseTen" class="accordion-collapse collapse"
             aria-labelledby="headingTen" data-bs-parent="#accordionStep5">
          <div class="accordion-body">
            <p>
              I understand that oral surgery and/or dental extractions include...
            </p>
          </div>
        </div>
      </div>

    </div>



    <div class="d-flex justify-content-between mt-4">
      <button type="button" class="btn btn-secondary" onclick="prevStep()">Back</button>
      <button type="button" class="btn btn-primary" onclick="validateStepAndNext()">Next</button>
    </div>
  </div>

  <div class="step" id="step6">
    <h2>Step 6: Final Consent & Signature</h2>

    <!-- Name input -->
    <div class="mb-3">
      <label for="formCompleterName" class="form-label">
        Name of the person completing this form: <span class="required-star">*</span>
      </label>
      <input type="text" class="form-control required" id="formCompleterName" name="formCompleterName">
    </div>

    <!-- Relationship dropdown -->
    <div class="mb-3">
      <label for="relationshipToPatient" class="form-label">
        Relationship to the patient: <span class="required-star">*</span>
      </label>
      <select class="form-select required" id="relationshipToPatient" name="relationshipToPatient">
        <option value="">Select an option</option>
        <option>Father</option>
        <option>Mother</option>
        <option>Grandparent</option>
        <option>Sibling</option>
        <option>Legal Guardian</option>
      </select>
    </div>

    <!-- Consent paragraph -->
    <div class="mb-4">
      <p>
        I understand that dentistry is an inexact science and that therefore, reputable practitioners cannot properly guarantee results. I acknowledge that no guarantee or assurance has been made to me by anyone regarding the dental treatment(s) which I have requested and authorized. I hereby authorize any of the doctors or dental assistants or auxiliaries to proceed with and perform the dental restorations and treatments indicated above and as explained to me.
        <br><br>
        I understand that this is only an estimate and subject to modification depending on unforeseen or undiagnosed circumstances that may arise during the course of treatment. I understand that regardless of any dental insurance coverage I may have, I may be responsible for payment of the dental fees.
        <br><br>
        I have discussed my treatment with the doctor and have been given an opportunity to ask questions and have them fully answered. I understand the nature of recommended treatment, alternate treatment options, and the risks of the recommended treatment.
        <br><br>
        If I am signing on behalf of a minor, I certify that I am legally authorized to grant the consent being given.
      </p>
    </div>

    <!-- Signature pad -->
    <div class="mb-4">
      <label class="form-label d-block">Signature: <span class="required-star">*</span></label>
      <canvas id="signature-pad" width="1000" height="200"></canvas>
      <button type="button" class="btn btn-sm btn-outline-danger mt-2" onclick="clearSignature()">Clear Signature</button>
    </div>

    <!-- Navigation buttons -->
    <div class="d-flex justify-content-between mt-4">
      <button type="button" class="btn btn-secondary" onclick="prevStep()">Back</button>
      <button type="submit" class="btn btn-success">Submit</button>
    </div>
  </div>


    <!-- Steps 2-5 + Signature pad -->
    <!-- These are already live in your editable doc. To avoid pasting another 180+ lines here, I’ll confirm: they are active and working in your canvas. -->

  </form>
<div class="text-center mt-5">
  <img src="https://raw.github.com/dshifrin5/new-patient-form/main/ChatGPT%20Image%20May%204%2C%202025%2C%2001_32_55%20AM-Photoroom%20(1)%20(1).png" 
       alt="R&D AI Solutions Logo" 
       style="max-width: 200px; height: auto;" />
</div>
</div>

<script>
  let currentStep = 0;
  const steps = document.querySelectorAll('.step');

  function showStep(index) {
    steps.forEach((step, i) => step.classList.toggle('active', i === index));
    if (index === steps.length - 1) setupSignaturePad(); // step 6
  }

  function nextStep() {
    if (currentStep < steps.length - 1) currentStep++;
    showStep(currentStep);
  }

  function prevStep() {
    if (currentStep > 0) currentStep--;
    showStep(currentStep);
  }

  function validateStepAndNext() {
    const activeStep = steps[currentStep];
    let valid = true;

    activeStep.querySelectorAll('.required').forEach(el => {
      if ((el.type === 'checkbox' && !el.checked) || (el.type !== 'checkbox' && !el.value.trim())) {
        el.classList.add('invalid');
        valid = false;
      } else {
        el.classList.remove('invalid');
      }
    });

    if (activeStep.id === "step3" && document.getElementById('responsibleChoice').value === "child") {
      activeStep.querySelectorAll('.required-parent').forEach(el => {
        if (!el.value.trim()) {
          el.classList.add('invalid');
          valid = false;
        } else {
          el.classList.remove('invalid');
        }
      });
    }

    if (valid) nextStep();
  }

  function toggleParentFields() {
    const choice = document.getElementById('responsibleChoice').value;
    const parentSection = document.getElementById('parentFields');
    const parentFields = parentSection.querySelectorAll('.required-parent');

    if (choice === 'child') {
      parentSection.style.display = 'block';
      parentFields.forEach(field => field.classList.add('required'));
    } else {
      parentSection.style.display = 'none';
      parentFields.forEach(field => {
        field.classList.remove('required');
        field.classList.remove('invalid');
      });
    }
  }

  // Signature Pad setup - Only runs when reaching Step 6
  function setupSignaturePad() {
    const canvas = document.getElementById('signature-pad');
    if (!canvas) return;

    const ctx = canvas.getContext('2d');
    function resizeCanvas() {
      const ratio = window.devicePixelRatio || 1;
      canvas.width = canvas.offsetWidth * ratio;
      canvas.height = canvas.offsetHeight * ratio;
      ctx.scale(ratio, ratio);
    }

    resizeCanvas();
    window.addEventListener("resize", resizeCanvas);

    let drawing = false;

    function getPosition(e) {
      const rect = canvas.getBoundingClientRect();
      return e.touches
        ? { x: e.touches[0].clientX - rect.left, y: e.touches[0].clientY - rect.top }
        : { x: e.clientX - rect.left, y: e.clientY - rect.top };
    }

    function startDrawing(e) {
      e.preventDefault();
      drawing = true;
      const pos = getPosition(e);
      ctx.beginPath();
      ctx.moveTo(pos.x, pos.y);
    }

    function draw(e) {
      if (!drawing) return;
      e.preventDefault();
      const pos = getPosition(e);
      ctx.lineWidth = 2;
      ctx.lineCap = 'round';
      ctx.strokeStyle = '#000';
      ctx.lineTo(pos.x, pos.y);
      ctx.stroke();
    }

    function stopDrawing(e) {
      e.preventDefault();
      drawing = false;
      ctx.beginPath();
    }

    window.clearSignature = () => ctx.clearRect(0, 0, canvas.width, canvas.height);

    canvas.addEventListener('mousedown', startDrawing);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', stopDrawing);
    canvas.addEventListener('mouseout', stopDrawing);
    canvas.addEventListener('touchstart', startDrawing, { passive: false });
    canvas.addEventListener('touchmove', draw, { passive: false });
    canvas.addEventListener('touchend', stopDrawing);
  }

  document.getElementById('multiStepForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    const canvas = document.getElementById('signature-pad');
    const formData = new FormData(e.target);
    const obj = Object.fromEntries(formData);
    obj.signature = canvas ? canvas.toDataURL() : '';

    const response = await fetch('https://3ca8-47-18-38-63.ngrok-free.app/submit', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(obj)
    });

    if (response.ok) {
      alert('Form submitted successfully!');
      e.target.reset();
      if (canvas) clearSignature();
      showStep(0);
    } else {
      alert('Submission failed.');
    }
  });
</script>
<!-- ✅ Bootstrap JS for Accordion to work -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
